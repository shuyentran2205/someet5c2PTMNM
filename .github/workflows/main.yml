# TÃªn cá»§a quy trÃ¬nh lÃ m viá»‡c (Workflow)
name: ğŸš€ Deploy to Somee via FTP

# Äiá»u kiá»‡n kÃ­ch hoáº¡t: Cháº¡y khi cÃ³ push lÃªn nhÃ¡nh main
on:
  push:
    branches:
      - main
  # Báº¡n cÅ©ng cÃ³ thá»ƒ thÃªm workflow_dispatch Ä‘á»ƒ cháº¡y thá»§ cÃ´ng
  # workflow_dispatch:

# CÃ¡c cÃ´ng viá»‡c (Jobs)
jobs:
  web-deploy:
    name: Deploy to Somee
    # Cháº¡y trÃªn mÃ´i trÆ°á»ng Ubuntu má»›i nháº¥t
    runs-on: ubuntu-latest

    # CÃ¡c bÆ°á»›c thá»±c hiá»‡n
    steps:
      # BÆ°á»›c 1: Checkout code tá»« repository
      - name: ğŸšš Get latest code
        uses: actions/checkout@v4

      # (TÃ¹y chá»n) Náº¿u báº¡n cÃ³ bÆ°á»›c build (vÃ­ dá»¥: .NET, Node.js), hÃ£y thÃªm vÃ o Ä‘Ã¢y
      # - name: Setup .NET
      #   uses: actions/setup-dotnet@v4
      #   with:
      #     dotnet-version: '8.0.x'
      # - name: Build and Publish
      #   run: dotnet publish -c Release -o deploy_folder --no-restore
      
      # BÆ°á»›c 2: Äá»“ng bá»™ hÃ³a file lÃªn server FTP
      - name: ğŸ“‚ Sync files to Somee via FTP
        # Sá»­ dá»¥ng SamKirkland/FTP-Deploy-Action
        uses: SamKirkland/FTP-Deploy-Action@v4.3.2
        with:
          # Äá»‹a chá»‰ mÃ¡y chá»§ FTP cá»§a Somee.com (vÃ­ dá»¥: ftp.somee.com)
          server: ${{ secrets.HOST_FTP }}
          # TÃªn ngÆ°á»i dÃ¹ng FTP. Tá»‘t nháº¥t nÃªn lÆ°u trong GitHub Secrets.
          username: ${{ secrets.USER_FTP }}
          # Máº­t kháº©u FTP. **Báº®T BUá»˜C** pháº£i lÆ°u trong GitHub Secrets.
          password: ${{ secrets.PASS_FTP }}
          # ThÆ° má»¥c chá»©a cÃ¡c file trÃªn GitHub (thÆ°á»ng lÃ  thÆ° má»¥c gá»‘c cá»§a repo hoáº·c thÆ° má»¥c build)
          local-dir: ./ # Hoáº·c ./deploy_folder/ náº¿u báº¡n cÃ³ bÆ°á»›c build
          # ThÆ° má»¥c Ä‘Ã­ch trÃªn server Somee.com (thÆ°á»ng lÃ  /wwwroot/ hoáº·c /site/wwwroot/ tÃ¹y cáº¥u hÃ¬nh)
          server-dir: /wwwroot/ 
          # Ghi Ä‘Ã¨ file má»›i hÆ¡n
          state-name: .ftp-deploy-sync-state.json
          # (TÃ¹y chá»n) Loáº¡i trá»« cÃ¡c file/thÆ° má»¥c khÃ´ng cáº§n thiáº¿t
          exclude: |
            **/.git*
            **/.git**
            **/node_modules/**
            **/web.config # Náº¿u báº¡n muá»‘n giá»¯ web.config trÃªn server
